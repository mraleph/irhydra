<!DOCTYPE html>
<link rel="import" href="../../../../packages/polymer/polymer.html">
<link rel="import" href="../modes/v8/ui/descriptions.html">
<link rel="import" href="dropdown-element.html">
<link rel="import" href="deopt-links.html">
<link rel="import" href="graph-pane.html">
<link rel="import" href="ir-pane.html">
<link rel="import" href="method-list.html">
<link rel="import" href="open-file-button.html">
<link rel="import" href="source-pane.html">
<link rel="import" href="source-path.html">
<link rel="import" href="spinner-element.html">
<link rel="import" href="util/switching-scope.html">

<polymer-element name="hydra-app">
  <template>
    <link rel="stylesheet" type="text/css" href="hydra.css">

    <div class="header">
      <open-file-button on-opened="{{openCompilation}}" data-title="Load Compilation Artifacts"><i class="fa fa-folder-open"></i></open-file-button>
      <template if="{{files != null}}">
        <button href="#" on-click="{{reloadCurrentFiles}}" title="Reload Current Files"><i class="fa fa-repeat"></i></button>
      </template>
      <spinner-element id="spinner"></spinner-element>
      <template if="{{ir != null}}">
        <switching-scope active="{{activeTab}}" class="pane-controls">
          <div when-ir class="tab-header"><a href="#ir">IR</a></div>
          <div when-graph class="tab-header"><a href="#graph">GRAPH</a></div>
          <template if="{{!sourcePath.isEmpty}}">
            <div when-source class="tab-header"><a href="#source">SOURCE</a></div>
          </template>
          <div when-ir>
            <dropdown-element selected="{{codeMode}}">
              <a data-value="split">Split Disassembly</a>
              <a data-value="inline">Inline Disassembly</a>
              <a data-value="none">Hide Disassembly</a>
            </dropdown-element>
          </div>
          <div when-ir when-source>
            <deopt-links deopts="{{phase.method.deopts}}" on-deopt-click="{{navigateToDeoptAction}}" on-deopt-enter="{{enterDeoptAction}}" on-deopt-leave="{{leaveDeoptAction}}">
            </deopt-links>
          </div>
          <div when-source>
            <source-path path="{{sourcePath}}">
            </source-path>
          </div>
        </switching-scope>
      </template>
    </div>

    <div class="pane">
      <template if="{{methods != null && !methods.isEmpty}}">
        <div class="sidebar">
          <method-list methods="{{methods}}" selected="{{phase}}"></method-list>
        </div>
        <template if="{{ir == null}}">
          <div class="ir-placeholder">
            <span>select a method</span>
          </div>
        </template>
        <template if="{{ir != null}}">
          <switching-scope active="{{activeTab}}" class="panes">
            <div when-ir>
              <ir-pane id="ir-pane" ir="{{ir}}" codeMode="{{codeMode}}" showSource="{{showSource}}"></ir-pane>
            </div>
            <div when-graph>
              <graph-pane ir="{{ir}}" on-block-mouse-over="{{showBlockAction}}" on-block-mouse-out="{{hideBlockAction}}">
              </graph-pane>
            </div>
            <div when-source>
              <source-pane id="source-pane" path="{{sourcePath}}" on-deopt-enter="{{enterDeoptAction}}" on-deopt-leave="{{leaveDeoptAction}}">
              </source-pane>
            </div>
          </switching-scope>
        </template>
      </template>
    </div>
  </template>
  <script type="application/dart" src="hydra.dart"></script>
</polymer-element>
